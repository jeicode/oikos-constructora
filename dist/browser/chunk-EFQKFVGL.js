import{a as Q}from"./chunk-V7DDNOIH.js";import{B as v,Bb as R,C as x,Da as M,Ea as S,Eb as N,Ja as z,Ka as _,La as O,Ma as k,Na as y,Pa as F,R as b,Ra as I,U as l,V as E,Wa as V,c as w,ca as m,cb as j,db as A,eb as D,ha as C,ia as p,mb as L,na as P,sa as o,ta as r,ua as h,x as T,xa as f,ya as u,za as c}from"./chunk-3FLNQWQU.js";function W(n,s){if(n&1){let e=f();o(0,"div",18),u("click",function(){v(e);let i=c();return x(i.activarEncuesta())}),h(1,"img",19),r()}if(n&2){let e=c();P("btn_flt_encuesta ",e.moveFlotante,"")}}function X(n,s){if(n&1&&(o(0,"option",33),_(1),r()),n&2){let e=s.$implicit,t=c(2).$implicit;p("value",e==null?null:e.titulo),C("id_encuesta",t==null?null:t.id),l(),O(e==null?null:e.titulo)}}function q(n,s){if(n&1){let e=f();o(0,"div",27)(1,"div",28)(2,"div",29),_(3),r(),o(4,"select",30),u("change",function(i){v(e);let a=c(3);return x(a.marcarPregunta(i))}),o(5,"option",31),_(6,"Seleccione"),r(),m(7,X,2,3,"option",32),r()()()}if(n&2){let e=c().$implicit;l(3),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(2),C("id_encuesta",e==null?null:e.id),l(2),p("ngForOf",e==null?null:e.opciones)}}function B(n,s){if(n&1){let e=f();o(0,"div",38),u("click",function(){let a=v(e).$implicit,d=c(2).$implicit,g=c(2);return x(g.marcarEscala(d==null?null:d.id,a))}),h(1,"input",39),o(2,"label",40)(3,"div",41),h(4,"img",42),r(),o(5,"div",43),_(6),r()()()}if(n&2){let e=s.$implicit,t=s.index,i=c(2).$implicit,a=c(2);l(),M("name","opc_",i==null?null:i.id,""),S("id","opc_",i==null?null:i.id,"_",t,""),l(),S("for","opc_",i==null?null:i.id,"_",t,""),l(2),M("src","assets/images/diseno/",a.imagenes_escala[t],"",b),l(2),k(" ",e," ")}}function G(n,s){if(n&1&&(o(0,"div",34)(1,"div",35),_(2),r(),o(3,"div",36),m(4,B,7,7,"div",37),r()()),n&2){let e=c().$implicit,t=c(2);l(2),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(2),p("ngForOf",t.escala)}}function H(n,s){if(n&1){let e=f();o(0,"div",27)(1,"div",28)(2,"div",29),_(3),r(),o(4,"textarea",44),u("change",function(i){v(e);let a=c(3);return x(a.marcarTextarea(i))}),r()()()}if(n&2){let e=c().$implicit;l(3),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(),C("id_encuesta",e==null?null:e.id)}}function J(n,s){if(n&1&&(o(0,"div"),m(1,q,8,4,"div",25)(2,G,5,3,"div",26)(3,H,5,3,"div",25),r()),n&2){let e=s.$implicit;l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="1"),l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="2"),l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="3")}}function K(n,s){if(n&1){let e=f();o(0,"div",20)(1,"div",8)(2,"div",9),_(3,"Queremos conocer tu opini\xF3n"),r()(),o(4,"div",21),m(5,J,4,3,"div",22),o(6,"div",23)(7,"div",14),u("click",function(){v(e);let i=c();return x(i.avanzarUnico())}),_(8,"Siguiente"),r()(),o(9,"p",24),_(10),r()()()}if(n&2){let e=c();l(5),p("ngForOf",e.encuesta[0].preguntas),l(5),O(e.showErrors)}}function Y(n,s){if(n&1&&(o(0,"option",33),_(1),r()),n&2){let e=s.$implicit,t=c(2).$implicit;p("value",e==null?null:e.titulo),C("id_encuesta",t==null?null:t.id),l(),O(e==null?null:e.titulo)}}function Z(n,s){if(n&1){let e=f();o(0,"div",27)(1,"div",28)(2,"div",29),_(3),r(),o(4,"select",30),u("change",function(i){v(e);let a=c(4);return x(a.marcarPregunta(i))}),o(5,"option",31),_(6,"Seleccione"),r(),m(7,Y,2,3,"option",32),r()()()}if(n&2){let e=c().$implicit;l(3),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(2),C("id_encuesta",e==null?null:e.id),l(2),p("ngForOf",e==null?null:e.opciones)}}function ee(n,s){if(n&1){let e=f();o(0,"div",38),u("click",function(){let a=v(e).$implicit,d=c(2).$implicit,g=c(3);return x(g.marcarEscala(d==null?null:d.id,a))}),h(1,"input",39),o(2,"label",40)(3,"div",41),h(4,"img",42),r(),o(5,"div",43),_(6),r()()()}if(n&2){let e=s.$implicit,t=s.index,i=c(2).$implicit,a=c(3);l(),M("name","opc_",i==null?null:i.id,""),S("id","opc_",i==null?null:i.id,"_",t,""),l(),S("for","opc_",i==null?null:i.id,"_",t,""),l(2),M("src","assets/images/diseno/",a.imagenes_escala[t],"",b),l(2),k(" ",e," ")}}function te(n,s){if(n&1&&(o(0,"div",34)(1,"div",35),_(2),r(),o(3,"div",36),m(4,ee,7,7,"div",37),r()()),n&2){let e=c().$implicit,t=c(3);l(2),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(2),p("ngForOf",t.escala)}}function ie(n,s){if(n&1){let e=f();o(0,"div",27)(1,"div",28)(2,"div",29),_(3),r(),o(4,"textarea",44),u("change",function(i){v(e);let a=c(4);return x(a.marcarTextarea(i))}),r()()()}if(n&2){let e=c().$implicit;l(3),y(" ",e==null?null:e.contar,". ",e==null?null:e.titulo," "),l(),C("id_encuesta",e==null?null:e.id)}}function ne(n,s){if(n&1&&(o(0,"div"),m(1,Z,8,4,"div",25)(2,te,5,3,"div",26)(3,ie,5,3,"div",25),r()),n&2){let e=s.$implicit;l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="1"),l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="2"),l(),p("ngIf",(e==null?null:e.tipo_pregunta)=="3")}}var U=n=>({active:n});function ae(n,s){if(n&1){let e=f();o(0,"div",46)(1,"div",8)(2,"div",9),_(3,"Queremos conocer tu opini\xF3n"),r()(),o(4,"div",21),m(5,ne,4,3,"div",22),o(6,"div",23)(7,"div",14),u("click",function(){let i=v(e),a=i.index,d=i.$implicit,g=c(2);return x(g.avanzarMultiple(a+1,d.preguntas.length))}),_(8,"Siguiente "),r()(),o(9,"p",24),_(10),r()()()}if(n&2){let e=s.$implicit,t=s.index,i=c(2);P("cnt_sec_modal paso",t,""),p("ngClass",I(6,U,t==0)),l(5),p("ngForOf",e.preguntas),l(5),O(i.showErrors)}}function oe(n,s){if(n&1&&m(0,ae,11,8,"div",45),n&2){let e=c();p("ngForOf",e.encuesta[0]==null?null:e.encuesta[0].secciones)}}var pe=(()=>{let s=class s{constructor(t,i){this.pageService=t,this.router=i,this.activarEncuestaS=!1,this.mostrarEncuesta=!1,this.encuesta=[],this.escala=["Para nada de acuerdo","En desacuerdo","Ni de acuerdo ni en desacuerdo","De acuerdo","Completamente de acuerdo"],this.imagenes_escala=["ic_encuesta_1.svg","ic_encuesta_2.svg","ic_encuesta_3.svg","ic_encuesta_4.svg","ic_encuesta_5.svg"],this.respuestas=[],this.opciones_marcadas=[],this.agrupada=1,this.showErrors="",this.token="",this.moveFlotante="",this.suscribeListenRouter=this.router.events.subscribe(a=>{if(a instanceof R){var d=i.url.split("/");d[1]=="proyecto"?this.moveFlotante="moveToLeft":this.moveFlotante=""}})}ngOnInit(){this.init()}ngOnDestroy(){this.suscribeListenRouter.unsubscribe()}init(){return w(this,null,function*(){yield this.getEncuestaActiva()})}getEncuestaActiva(){return w(this,null,function*(){this.encuesta=yield this.pageService.getEncuestaActiva(this.agrupada),this.encuesta?.[0]?.id_encuesta&&(this.mostrarEncuesta=!0)})}activarEncuesta(t){this.activarEncuestaS=!this.activarEncuestaS,this.avanzar("portada"),this.token="",this.opciones_marcadas=[],this.respuestas=[],$(".inp_modal").val(0),$(".radio_modal").prop("checked",!1)}avanzar(t){$(".cnt_sec_modal").removeClass("active"),$("."+t).addClass("active")}avanzarUnico(){return w(this,null,function*(){if(this.opciones_marcadas.length==this.encuesta[0].preguntas.length){let t=yield this.pageService.setRespuestaEncuesta(this.opciones_marcadas,this.token);this.token=t[0].token,$(".cnt_sec_modal").removeClass("active"),$(".final").addClass("active"),setTimeout(()=>{this.mostrarEncuesta=!1,this.token=""},1500)}else this.showErrors="Debes marcar todas las preguntas",setTimeout(()=>{this.showErrors=""},3e3)})}marcarPregunta(t){let i=t.target.selectedIndex,a=t.target.options[i].getAttribute("id_encuesta"),d=t.target.value;if(d!=""&&d!=null&&d!=null)if(!this.respuestas.includes(a))this.respuestas.push(a),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:a,valor:d});else{let g=this.respuestas.indexOf(a);this.respuestas.splice(g,1),this.opciones_marcadas.splice(g,1),this.respuestas.push(a),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:a,valor:d})}else{let g=this.respuestas.indexOf(a);this.respuestas.splice(g,1),this.opciones_marcadas.splice(g,1)}}marcarEscala(t,i){if(!this.respuestas.includes(t))this.respuestas.push(t),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:t,valor:i});else{let a=this.respuestas.indexOf(t);this.respuestas.splice(a,1),this.opciones_marcadas.splice(a,1),this.respuestas.push(t),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:t,valor:i})}}marcarTextarea(t){let i=t.target.getAttribute("id_encuesta"),a=t.target.value;if(a!=""&&a!=null&&a!=null)if(!this.respuestas.includes(i))this.respuestas.push(i),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:i,valor:a});else{let d=this.respuestas.indexOf(i);this.respuestas.splice(d,1),this.opciones_marcadas.splice(d,1),this.respuestas.push(i),this.opciones_marcadas.push({id_encuesta:this.encuesta[0].id_encuesta,id_pregunta:i,valor:a})}else{let d=this.respuestas.indexOf(i);this.respuestas.splice(d,1),this.opciones_marcadas.splice(d,1)}}avanzarMultiple(t,i){return w(this,null,function*(){if(i==this.opciones_marcadas.length){let a=yield this.pageService.setRespuestaEncuesta(this.opciones_marcadas,this.token);this.token=a[0].token,this.encuesta[0].secciones.length==t?($(".cnt_sec_modal").removeClass("active"),$(".final").addClass("active"),setTimeout(()=>{this.mostrarEncuesta=!1,this.token=""},1500)):($(".cnt_sec_modal").removeClass("active"),$(".paso"+t).addClass("active")),this.respuestas=[],this.opciones_marcadas=[]}else this.showErrors="Debes marcar todas las preguntas",this.showErrors=""})}};s.\u0275fac=function(i){return new(i||s)(E(Q),E(N))},s.\u0275cmp=T({type:s,selectors:[["survey-modal"]],standalone:!0,features:[F],decls:33,vars:6,consts:[["style","cursor:pointer",3,"class","click",4,"ngIf"],[1,"layer",3,"ngClass"],[1,"cnt_gen_modal"],[1,"cnt_modal"],[1,"cerrar_modal",3,"click"],[1,"material-icons"],["action","","id","myform",1,"cnt_form_modal"],[1,"cnt_sec_modal","portada"],[1,"top_azul_modal"],[1,"h_modal"],[1,"txt_modal"],[1,"portada_modal"],[1,"logo_modal"],["loading","lazy","src","assets/images/diseno/logo_constructora.svg","alt",""],[1,"btn","btn_modal",3,"click"],["class","cnt_sec_modal paso0 active",4,"ngIf","ngIfElse"],["encuestaAgrupada",""],[1,"cnt_sec_modal","final"],[2,"cursor","pointer",3,"click"],["src","assets/images/diseno/ic_encuesta.svg","alt",""],[1,"cnt_sec_modal","paso0","active"],[1,"cnt_preg"],[4,"ngFor","ngForOf"],[1,"row_preg_1"],[1,"error-text"],["class","list_dropdown",4,"ngIf"],["class","escala",4,"ngIf"],[1,"list_dropdown"],[1,"cntpreg_dropdown"],[1,"txt_preg"],[1,"input","inp_modal",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"escala"],[1,"preg_radio"],[1,"row_radios_modal"],["class","itm_radio_modal",3,"click",4,"ngFor","ngForOf"],[1,"itm_radio_modal",3,"click"],["type","radio",1,"radio_modal",3,"name","id"],["for","",1,"cnt_if_radio_modal",3,"for"],[1,"ic_radio_modal"],["alt","",3,"src"],[1,"txt_radio_modal"],["name","","id","","cols","30","rows","10",3,"change"],[3,"class","ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(i,a){if(i&1&&(m(0,W,2,3,"div",0),o(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),u("click",function(){return a.activarEncuesta("cerrar")}),o(5,"span",5),_(6,"cancel"),r()(),o(7,"form",6)(8,"div",7)(9,"div",8)(10,"div",9),_(11,"Queremos conocer tu opini\xF3n"),r(),o(12,"div",10),_(13," Esta encuesta no te tomar\xE1 m\xE1s de 2 minutos "),r()(),o(14,"div",11)(15,"div",12),h(16,"img",13),r(),o(17,"div",14),u("click",function(){return a.avanzar("paso0")}),_(18,"Continuar"),r()()(),m(19,K,11,2,"div",15)(20,oe,1,1,"ng-template",null,16,V),o(22,"div",17)(23,"div",8)(24,"div",9),_(25," Muchas gracias por "),h(26,"br"),_(27," tu colaboraci\xF3n "),r()(),o(28,"div",11)(29,"div",12),h(30,"img",13),r(),o(31,"div",14),u("click",function(){return a.activarEncuesta()}),_(32,"Cerrar"),r()()()()()()()),i&2){let d=z(21);p("ngIf",a.mostrarEncuesta),l(),p("ngClass",I(4,U,a.activarEncuestaS)),l(18),p("ngIf",a.agrupada==0)("ngIfElse",d)}},dependencies:[L,j,A,D],styles:['.layer[_ngcontent-%COMP%]{width:100%;background:#0009;height:100%;position:fixed;top:0;left:0;z-index:30;overflow-y:auto;opacity:0;display:none;animation:_ngcontent-%COMP%_fadeIn 1s forwards}.layer.active[_ngcontent-%COMP%]{display:block}.cnt_gen_modal[_ngcontent-%COMP%]{width:95%;max-width:600px;position:absolute;top:10%;left:50%;transform:translate(-50%);position:relative}.cnt_modal[_ngcontent-%COMP%]{border-radius:20px;background:#fff;overflow:hidden;box-shadow:0 13px 30px -8px #00000040}.top_azul_modal[_ngcontent-%COMP%]{width:100%;display:flex;background:var(--c_pri);padding:16px 48px;color:#fff;flex-direction:column;align-items:center;overflow:hidden;box-shadow:0 13px 30px -8px #00000040;position:relative;z-index:1}.h_modal[_ngcontent-%COMP%]{width:100%;font-size:24px;font-weight:900;text-align:center;padding:16px 0}.txt_modal[_ngcontent-%COMP%]{font-size:16px;text-align:center;padding:16px 0;border-top:1px solid #fff}.cerrar_modal[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;cursor:pointer;z-index:2}.cerrar_modal[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.cerrar_modal[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#fff}.cnt_form_modal[_ngcontent-%COMP%]{width:100%}.cnt_sec_modal[_ngcontent-%COMP%]{width:100%;display:none;opacity:0;animation:_ngcontent-%COMP%_fadeIn .5s forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.cnt_sec_modal.active[_ngcontent-%COMP%]{display:block}.portada_modal[_ngcontent-%COMP%]{width:100%;padding:64px 48px;display:flex;flex-direction:column;gap:32px;align-items:center;background:url("./media/bg_encuesta-CWLXQM3L.png") no-repeat center;background-size:cover}.logo_modal[_ngcontent-%COMP%]{width:130px}.logo_modal[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.btn.btn_modal[_ngcontent-%COMP%]{width:260px}.cnt_preg[_ngcontent-%COMP%]{padding:64px;background:#fff}.list_dropdown[_ngcontent-%COMP%]{width:100%}.cntpreg_dropdown[_ngcontent-%COMP%]{padding:24px 0;border-bottom:1px solid #ccc}.cntpreg_dropdown[_ngcontent-%COMP%]:last-child{border-bottom:none}.txt_preg[_ngcontent-%COMP%]{font-size:16px;color:#626262;box-sizing:border-box;padding:0 16px 4px}.input.inp_modal[_ngcontent-%COMP%]{height:35px;padding:0 12px}.row_preg_1[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:32px 0 0}.preg_radio[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:18px;color:#626262;padding:16px 0;border-bottom:1px solid #ccc}.row_radios_modal[_ngcontent-%COMP%]{width:100%;display:flex;gap:20px;padding:24px 0}.itm_radio_modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;width:19%;flex-grow:1;align-items:center}.radio_modal[_ngcontent-%COMP%]{display:none}.cnt_if_radio_modal[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:12px;height:100%}.radio_modal[_ngcontent-%COMP%]:checked ~ .cnt_if_radio_modal[_ngcontent-%COMP%]   .ic_radio_modal[_ngcontent-%COMP%]{background:#bcccf8;box-shadow:none;transform:scale(1)}.cnt_if_radio_modal[_ngcontent-%COMP%]:hover   .ic_radio_modal[_ngcontent-%COMP%]{transform:scale(1.1)}.ic_radio_modal[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(104.32deg,#fff,#e4e4e4),#c2c2c2;box-shadow:0 4px 4px #00000040;padding:8px;border-radius:8px;transition:all .3s}.txt_radio_modal[_ngcontent-%COMP%]{font-size:12px;line-height:12px;color:var(--c_pri);text-align:center;width:100%;display:flex;flex-grow:1;align-items:center;font-weight:700}.btn_flt_encuesta[_ngcontent-%COMP%]{position:fixed;bottom:5%;right:23px;width:70px;height:70px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135.57deg,#4565b3,#2b478b 54.17%,#13203e);border-radius:50%;box-shadow:2px 2px 10px 5px #2e3b8540;z-index:10}.moveToLeft[_ngcontent-%COMP%]{bottom:5%;left:23px}@media screen and (max-width:1050px){.top_azul_modal[_ngcontent-%COMP%]{padding:32px 24px 0}.cnt_preg[_ngcontent-%COMP%]{padding:24px 32px}}@media screen and (max-width:480px){.h_modal[_ngcontent-%COMP%]{font-size:20px}.row_radios_modal[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.itm_radio_modal[_ngcontent-%COMP%]{width:100%}.cnt_if_radio_modal[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row}.ic_radio_modal[_ngcontent-%COMP%]{min-width:40px;width:40px;height:40px}.txt_radio_modal[_ngcontent-%COMP%]{font-size:16px;line-height:18px;text-align:left}.btn_flt_encuesta[_ngcontent-%COMP%]{width:45px;height:45px;padding:8px}.btn_flt_encuesta[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}}.error-text[_ngcontent-%COMP%]{color:red;font-size:13px;text-align:center;width:100%}.btn_flt_encuesta[_ngcontent-%COMP%]:after{content:"";width:30px;height:30px;border-radius:100%;border:5px #182360 solid;position:absolute;z-index:-1;animation:_ngcontent-%COMP%_ring 1.5s infinite}.btn_flt_encuesta[_ngcontent-%COMP%]:hover:after{display:none;-webkit-animation:none;animation:none}@-webkit-keyframes _ngcontent-%COMP%_ring{0%{width:60px;height:60px;opacity:1}to{width:150px;height:150px;opacity:0}}@keyframes _ngcontent-%COMP%_ring{0%{width:60px;height:60px;opacity:1}to{width:150px;height:150px;opacity:0}}']});let n=s;return n})();export{pe as SurveyModalComponent};
